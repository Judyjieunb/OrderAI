# 25S 시즌 판매 효율 분석 및 26S 발주 최적화 프로젝트
## 분석 플로우 및 로직 요약

---

## 📋 프로젝트 개요

**목적**: 25S 시즌 판매 데이터를 분석하여 시즌 건강도를 진단하고, 26S 시즌 발주 최적화를 위한 인사이트 제공

**입력**: `sql_result_raw.xlsx` (판매/입고/재고 데이터)  
**출력**: `25S_Analysis_Result.xlsx` (4개 시트 + 시각화 차트 포함)

---

## 🔄 전체 분석 플로우

```
[1단계] 데이터 로딩 및 전처리
    ↓
[2단계] Level 1: 전체 시즌 건강도 진단
    ↓
[3단계] Level 2: 복종별 밸런스 분석
    ↓
[4단계] Level 3: 아이템별 효율 분석 (BCG Matrix)
    ↓
[5단계] Level 4: 스타일 상세 분석
    ↓
[6단계] 결과 엑셀 파일 생성
    ↓
[7단계] 시각화 차트 생성 및 삽입
```

---

## 📊 단계별 상세 로직

### 1단계: 데이터 로딩 및 전처리

**주요 기능**:
- 엑셀 파일 로드 및 컬럼명 표준화
- 다양한 컬럼명 패턴 자동 매핑 (유연한 데이터 처리)
- 25S 시즌(당해) 데이터 필터링
- 결측치 처리 및 수치형 데이터 변환
- 재고수량 자동 계산 (입고수량 - 판매수량)

**핵심 로직**:
```python
# 컬럼명 패턴 매핑 (다양한 변형 지원)
- SEASON_GB: ['당해', 'SEASON_GB', '시즌구분', '시즌']
- CLASS2: ['PRDT_KIND_NM', 'CLASS2', '중분류', 'PRDT_KIND']
- SALE_QTY: ['SALE_NML_QTY_CNS', 'SALE_QTY', '판매수량', '판매']
- 등등...

# 발주수량 우선순위: ORDER_QTY > IN_QTY
# 재고수량 계산: STOCK_QTY = IN_QTY - SALE_QTY (음수 방지)
```

---

### 2단계: Level 1 - 전체 시즌 건강도 진단

**분석 목표**: 시즌 전체의 판매 효율 및 재고 리스크 평가

**계산 지표**:
- **판매율** = (총판매수량 / 총입고수량) × 100
- **재고리스크** = (총재고수량 / 총입고수량) × 100
- **목표달성여부**: 판매율 60% 기준

**AI 코멘트 생성 로직**:
| 판매율 | 등급 | 코멘트 |
|--------|------|--------|
| ≥ 75% | 우수 | 🔥 목표 대비 달성, 재고 리스크 매우 낮음 |
| ≥ 60% | 양호 | ✅ 목표 달성, 재고 리스크 적정 |
| ≥ 40% | 주의 | ⚠️ 목표 미달, 재고 관리 필요 |
| < 40% | 위험 | 🔴 목표 대비 크게 미달, 즉시 조치 필요 |

**출력**: Summary 시트에 종합 지표 및 AI 코멘트

---

### 3단계: Level 2 - 복종별 밸런스 분석

**분석 목표**: 복종(CLASS2)별 물량 비중과 판매 비중의 균형 평가

**계산 지표**:
- **물량비중** = (복종별 입고수량 / 전체 입고수량) × 100
- **판매비중** = (복종별 판매수량 / 전체 판매수량) × 100
- **비중차이** = 판매비중 - 물량비중
- **판매율** = (복종별 판매수량 / 복종별 입고수량) × 100

**밸런스 판정 로직**:
```
비중차이 > +5%p  → "확대필요" (판매 비중이 물량 비중보다 높음)
비중차이 < -5%p  → "축소필요" (물량 비중이 판매 비중보다 높음)
-5%p ≤ 비중차이 ≤ +5%p  → "적정" (균형 상태)
```

**AI 코멘트 예시**:
- 확대필요: "판매 비중이 물량 비중보다 높아 효율 우수. 26S 시즌 물량 비중 확대 검토 필요"
- 축소필요: "물량 비중이 판매 비중보다 높아 과도 발주. 26S 시즌 물량 비중 축소 검토 필요"

**출력**: Class_Analysis 시트 + 복종별 밸런스 차트 + 포트폴리오 파이 차트

---

### 4단계: Level 3 - 아이템별 효율 분석 (BCG Matrix)

**분석 목표**: 아이템(ITEM_NM)별 성장성과 시장 점유율 평가

**BCG Matrix 분류 기준**:
- **X축**: 물량 비중 (시장 점유율)
- **Y축**: 판매율 (성장성)
- **중앙값 기준** 4분면 분류

**BCG 분류**:
```
┌─────────────────┬─────────────────┐
│ Question Mark   │      Star        │
│ (잠재 성장주)    │  (핵심 성장동력)  │
│ 판매율↑ 물량비중↓│ 판매율↑ 물량비중↑│
├─────────────────┼─────────────────┤
│ Problem Child   │    Cash Cow      │
│ (저효율군)       │  (안정 수익원)    │
│ 판매율↓ 물량비중↑│ 판매율↓ 물량비중↓│
└─────────────────┴─────────────────┘
```

**등급 부여** (판매율 기준):
- **S등급**: ≥ 75% (부족 현상, 공급 확대 필요)
- **A등급**: ≥ 65% (우수한 성과)
- **B등급**: ≥ 55% (적정 수준)
- **C등급**: ≥ 40% (둔화 추세)
- **D등급**: < 40% (위험 수준)

**AI 코멘트 전략**:
- **Star**: "성장 주도 아이템. 26S 시즌 물량 확대 권장"
- **Cash Cow**: "매출 지지 아이템. 현행 유지 또는 소폭 확대"
- **Problem Child**: "효율 저하 요인. 물량 축소 또는 스타일 재검토"
- **Question Mark**: "관찰 필요 아이템"

**출력**: Item_Analysis 시트 + BCG 매트릭스 포지셔닝 맵

---

### 5단계: Level 4 - 스타일 상세 분석

**분석 목표**: 개별 스타일(STYLE_CD)별 상세 진단 및 액션 가이드 제공

**계산 지표**:
- **판매율** = (스타일별 판매수량 / 스타일별 발주수량) × 100
- **등급**: S/A/B/C/D (판매율 기준, 아이템 분석과 동일)
- **액션**: 등급별 자동 매핑

**액션 가이드 매핑**:
| 등급 | 액션 | 의미 |
|------|------|------|
| S | Aggressive | 물량 30% 이상 확대 검토 |
| A | Expand | 핵심 상품군으로 육성, 물량 확대 검토 |
| B | Maintain | 현행 유지 |
| C | Observation | 반응 생산 전환, 보수적 운영 |
| D | Cut/Drop | 스타일 축소 및 디자인 재검토 |

**AI 코멘트 생성 로직** (3단계):

**Logic 1: 복종별 효율 진단 분기**
- **의류**: 판매율 기준 진단
  - > 75%: "물량부족, 조기 품절로 기회비용 발생"
  - 65-75%: "베스트, 핵심 상품군으로 육성 필요"
  - 55-65%: "정상, 현행 유지 가능"
  - 40-55%: "둔화, 반응 생산 전환 권장"
  - < 40%: "재고위험, 스타일 Drop 필요"

- **용품**: 재고주수(WOS) 기준 진단
  - 모자: 적정 WOS 6주
  - 가방: 적정 WOS 10주
  - 신발: 적정 WOS 12주
  - 기타: 적정 WOS 8주
  - WOS < 적정치 × 0.8: "재고부족, 긴급 리오더 필요"
  - WOS > 적정치 × 1.3: "재고과다, 프로모션 시급"

**Logic 2: 스타일 유형별 판단**
- **볼륨 드라이버**: 판매율 55-65% + 판매수량 ≥ 500
  → "매출 방어용 기본물로 유지 필요"
- **히트 아이템**: 판매율 ≥ 80%
  → "조기 소진, 스타일 수평 전개(Color/Graphic 추가) 권장"
- **VMD 아이템**: 판매량 < 50 + 발주수량 < 100 + 판매율 ≥ 40%
  → "구색상 필요, 최소 진열 수량만 운영 권장"

**Logic 3: 등급별 액션 가이드**
- 등급에 따른 26S 시즌 발주 가이드 자동 생성

**출력**: Style_Action_Plan 시트 + 스타일 산점도

---

### 6-7단계: 결과 엑셀 파일 생성 및 시각화

**엑셀 시트 구성**:
1. **Summary**: 전체 시즌 건강도 지표 + AI 종합 코멘트
2. **Class_Analysis**: 복종별 밸런스 분석 결과
3. **Item_Analysis**: 아이템별 BCG Matrix 분석 결과
4. **Style_Action_Plan**: 스타일별 상세 분석 및 액션 가이드

**시각화 차트** (5개):
1. **BCG 매트릭스 포지셔닝 맵** (Item_Analysis 시트)
   - X축: 물량 비중, Y축: 판매율
   - 버블 크기: 판매 비중
   - 4분면 색상 구분

2. **복종별 밸런스 차트** (Class_Analysis 시트)
   - 수평 막대 차트
   - ±5%p 기준선 표시
   - 색상: 확대필요(빨강) / 적정(연두) / 축소필요(청록)

3. **복종별 포트폴리오 파이 차트** (Class_Analysis 시트)
   - 물량 비중 vs 판매 비중 비교

4. **판매율 분포 차트** (Summary 시트)
   - 등급별 스타일 개수 바 차트
   - 판매율 히스토그램 (평균선 포함)

5. **스타일 산점도** (Style_Action_Plan 시트)
   - X축: 발주수량 (로그 스케일)
   - Y축: 판매율
   - 등급별 색상 구분
   - 등급 기준선 표시

---

## 🎯 핵심 분석 로직 요약

### 판매율 계산 공식
```
판매율 = (판매수량 / 발주수량) × 100
```
- 발주수량 우선순위: ORDER_QTY > IN_QTY

### 밸런스 판정 기준
```
비중차이 = 판매비중 - 물량비중
- 비중차이 > +5%p: 확대필요
- 비중차이 < -5%p: 축소필요
- 그 외: 적정
```

### BCG Matrix 분류
```
중앙값 기준 4분면 분류:
- Star: 판매율 ≥ 중앙값 AND 물량비중 ≥ 중앙값
- Cash Cow: 판매율 ≥ 중앙값 AND 물량비중 < 중앙값
- Problem Child: 판매율 < 중앙값 AND 물량비중 ≥ 중앙값
- Question Mark: 판매율 < 중앙값 AND 물량비중 < 중앙값
```

### 등급 부여 기준
```
S: ≥ 75%  |  A: ≥ 65%  |  B: ≥ 55%  |  C: ≥ 40%  |  D: < 40%
```

---

## 📈 출력 결과물

**엑셀 파일**: `25S_Analysis_Result.xlsx`
- 4개 시트 (Summary, Class_Analysis, Item_Analysis, Style_Action_Plan)
- 5개 시각화 차트 (각 시트에 삽입)
- AI 코멘트 포함 (모든 분석 레벨)

**주요 활용 방안**:
1. **Summary**: 시즌 전체 성과 파악
2. **Class_Analysis**: 복종별 포트폴리오 최적화
3. **Item_Analysis**: 성장 아이템 발굴 및 투자 우선순위 결정
4. **Style_Action_Plan**: 개별 스타일별 26S 시즌 발주 전략 수립

---

## 🔧 기술 스택

- **언어**: Python 3.x
- **주요 라이브러리**: 
  - pandas (데이터 처리)
  - numpy (수치 계산)
  - matplotlib (시각화)
  - openpyxl (엑셀 파일 생성/편집)
- **입력 형식**: Excel (.xlsx)
- **출력 형식**: Excel (.xlsx) + PNG 이미지 (차트)

---

## 📝 주요 특징

1. **유연한 데이터 처리**: 다양한 컬럼명 패턴 자동 인식 및 매핑
2. **다층 분석**: 전체 → 복종 → 아이템 → 스타일 (4단계 계층 분석)
3. **AI 기반 인사이트**: 각 레벨별 자동 코멘트 생성
4. **시각화 통합**: 분석 결과를 차트로 시각화하여 엑셀에 삽입
5. **액션 가이드**: 26S 시즌 발주 최적화를 위한 구체적 가이드 제공

---

*문서 생성일: 2024년*  
*프로젝트: 25S 시즌 판매 효율 분석 및 26S 발주 최적화*





