# 📊 AI 수요 예측 및 기회비용 분석 로직 명세서

## 1. 개요 (Overview)
본 알고리즘은 패션 상품의 판매 데이터를 분석하여 **물리적 품절**뿐만 아니라 사이즈 불균형으로 인한 **상업적 결품(Broken Assortment)** 구간을 식별합니다. 해당 구간 동안 정상적으로 재고가 공급되었을 경우의 **잠재 수요(Potential Demand)**를 시뮬레이션하여, 놓친 매출 기회비용(Revenue Loss)을 정량화합니다.

---

## 2. 결품 감지 메커니즘 (Stock-out Detection)
AI는 다음 두 가지 조건 중 하나라도 충족될 경우, 해당 시점을 '결품 구간'으로 진단하고 시뮬레이션을 시작합니다.

### A. 물리적 품절 (Physical Stock-out)
* **정의**: 재고가 소진되어 판매가 불가능한 상태
* **Trigger 조건**: `현재 재고량 < 5장`

### B. 상업적 결품 (Commercial Stock-out / Broken Assortment)
* **정의**: 재고 수량은 남아있으나(예: 300장), 주요 황금 사이즈가 소진되어 판매 속도가 비정상적으로 급락한 상태
* **Trigger 조건 (AND 조건)**:
    1.  **높은 소진율**: `누적 판매율(Sell-Through) ≥ 70%`
    2.  **재고 잔존**: `현재 재고량 > 0`
    3.  **판매 급락**: `주간 판매량 < (직전 4주 평균 판매량 × 50%)`

---

## 3. 수요 예측 모델링 (Forecasting Model)

결품 이후의 판매량은 단순 평균이 아닌, **시즌 종료 시점에 맞춰 자연스럽게 하향 안정화되는 곡선**을 그립니다. 이를 위해 **[목표 기반 감쇠 모델 (Goal-Oriented Decay Model)]**을 사용합니다.

### A. 핵심 전제 (Assumption)
1.  **기초 체력 유지**: 결품 직전 4주간의 평균 판매 속도가 해당 스타일의 '잠재력'이다.
2.  **시즌성 반영 (Seasonality)**: 패션 상품은 시즌 종료일(9월 30일)에 가까워질수록 고객 수요가 자연 감소한다.
3.  **수렴 목표 (Convergence)**: 시즌 종료일에는 잠재 판매량이 최소 단위(10장)로 수렴해야 한다.

### B. 예측 프로세스
1.  **Base Velocity 산출**: 결품 직전 4주간의 잠재 판매량 평균($P_{avg}$) 계산
2.  **잔여 기간($W$) 산출**: 현재 시점부터 시즌 종료일(9.30)까지 남은 주(Week) 수 계산
3.  **동적 감쇠율($r$) 역산**: 현재 판매량이 남은 기간 동안 줄어들어 10장이 되기 위한 매주 감소 비율 계산
4.  **Forecasting**: 매주 전주 판매량에 감쇠율($r$)을 곱하여 미래 수요 예측

---

## 4. 수학적 공식 (Mathematical Formula)

### ① 동적 감쇠율 (Adaptive Decay Rate)
시즌 종료 시점($t_{end}$)에 목표 판매량($Target=10$)에 도달하기 위한 주간 감쇠율($r$)을 역산합니다.

$$
P_{avg} \times r^W = Target
$$

이를 $r$에 대해 정리하면:

$$
r = \left( \frac{10}{P_{avg}} \right)^{\frac{1}{W}}
$$

> * $r$: 주간 감쇠율 (Decay Rate)
> * $P_{avg}$: 결품 직전 4주 평균 판매량 (Peak Sales Velocity)
> * $W$: 시즌 종료까지 남은 주차 (Weeks Remaining)
> * $10$: 시즌 종료 시점 목표 판매량 (Terminal Value)

### ② 기회비용 (Opportunity Loss)
예측된 잠재 판매량에서 실제 발생한 판매량을 차감하여 산출합니다.

$$
Loss_{t} = \text{max}(0, \ P_{predicted, t} - P_{actual, t})
$$

---

## 5. 시뮬레이션 예시 (Simulation Example)

**상황**: 5월 말(W20), 주간 200장씩 팔리던 상품이 재고 300장을 남기고 판매량이 50장으로 급락함 (Broken Assortment 감지). 시즌 종료(9월 말)까지 18주 남음.

1.  **초기값**: $P_{avg} = 200$, $W = 18$
2.  **감쇠율 계산**:
    $$r = (10 / 200)^{1/18} \approx 0.84$$
    *(매주 전주 대비 약 84% 수준으로 수요가 자연 감소함)*
3.  **예측 전개**:
    * W21: $200 \times 0.84 = 168$장 (실판매 50장 → Loss **118장**)
    * W22: $168 \times 0.84 = 141$장 (실판매 30장 → Loss **111장**)
    * ... (점차 감소) ...
    * W38(종료): $\approx 10$장 수렴

---

## 6. 비즈니스 활용 가치 (Business Impact)
* **정교한 손실 측정**: 단순 품절 기간뿐만 아니라, 사이즈 깨짐으로 인한 '보이지 않는 손실'까지 포착합니다.
* **과대 예측 방지**: 시즌 말로 갈수록 판매량이 0에 수렴하도록 설계되어, 비현실적인 기회비용 산출을 방지합니다.
* **발주 최적화 근거**: 다음 시즌 기획 시, 단순히 "작년에 품절됐다"가 아니라 **"작년에 1,200장(약 4천만 원)을 더 팔 수 있었다"**는 구체적인 Upsize 근거를 제공합니다.